<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Panel LIFEPAR</title>
  <link href="https://fonts.googleapis.com/css2?family=Anton&family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <style>
    /* Bloqueo visual: nada se ve hasta que el c√≥digo d√© el OK */
    body { display: none; background-color: #000; }
  </style>
</head>
<body>
  <header>
    <div style="display: flex; align-items: center; justify-content: center; gap: 15px; padding: 15px;">
      <img id="userPhoto" src="" alt="Perfil" style="width: 50px; height: 50px; border-radius: 50%; border: 2px solid #fff; display: none; object-fit: cover;">
      <h2 id="userGreeting" style="font-family: 'Anton', sans-serif; color: white; margin: 0; font-size: 24px;">VERIFICANDO...</h2>
    </div>
  </header>

  <div class="contenedor">
    <main class="contenido-principal">
      <div class="info">
        <h2>Panel de Entrenadores</h2>
        <p>Gesti√≥n de zonas y seguros</p>
      </div>

      <section class="info">
        <h3>Zonas de trabajo</h3>
        <div class="zonas-grid">
          <div class="zona-card" onclick="toggleMenuZona(1)">Zona 1</div>
          <div class="zona-card" onclick="toggleMenuZona(2)">Zona 2</div>
          <div class="zona-card" onclick="toggleMenuZona(3)">Zona 3</div>
          <div class="zona-card" onclick="toggleMenuZona(4)">Zona 4</div>
          <div class="zona-card" onclick="toggleMenuZona(5)">Zona 5</div>
          <div class="zona-card" onclick="toggleMenuZona(6)">Zona 6</div>
        </div>

        <div class="menu-zona" id="menu-zona1" data-visible="false">
          <h4>Acciones Zona 1</h4>
          <ul>
            <li>üìù <button onclick="redirigirFormulario('zona1')">Cargar patinadoras/es</button></li>
          </ul>
        </div>
        </section>

      <section class="info">
        <h3>Gesti√≥n de Seguros</h3>
        <ul>
          <li><a href="https://forms.gle/qZJS945CVCF6spgA9" target="_blank">‚ûï Cargar seguro nuevo</a></li>
        </ul>
      </section>
    </main>
  </div>

  <script>
    const emailLogueado = localStorage.getItem("emailUsuario");
    const nombreLogueado = localStorage.getItem("nombreUsuario");
    const urlScript = "https://script.google.com/macros/s/AKfycbwoefOQGZ4rIlNj_XOG9UPSt7pvn1u4apuPmDUYMYepYZ5jx8pEwSyykoo7TYn9pRgWBg/exec"; 

    // Validaci√≥n estricta
    if (!emailLogueado || !nombreLogueado) {
        window.location.href = "index.html";
    } else {
        fetch(urlScript + "?email=" + encodeURIComponent(emailLogueado))
          .then(res => res.text())
          .then(resultado => {
            if (resultado.trim() === "SI") {
              // SOLO SI EL SHEETS DICE SI, MOSTRAMOS LA WEB
              document.body.style.display = "block";
              document.getElementById("userGreeting").innerText = "HOLA " + nombreLogueado.toUpperCase();
              const foto = localStorage.getItem("fotoUsuario");
              if (foto) {
                const img = document.getElementById("userPhoto");
                img.src = foto;
                img.style.display = "block";
              }
            } else {
              alert("ACCESO DENEGADO");
              localStorage.clear();
              window.location.href = "index.html";
            }
          })
          .catch(err => {
            alert("ERROR DE CONEXI√ìN - REINTENTE");
            window.location.href = "index.html";
          });
    }

    // Tus funciones de formularios (manten√© las que ya ten√≠as)
    const formularios = {
      zona1: { "Fecha 2": "https://forms.gle/kfLc9fKG6d5jkY2N7", "Fecha 3": "https://forms.gle/g9L7LY5SjBu2EyRQ8", "Fecha 4": "https://forms.gle/47ZhySBimn6h4frR9" },
      // ... agregar el resto de zonas aqu√≠
    };

    function redirigirFormulario(zona) {
      const menu = document.getElementById(`menu-${zona}`);
      const select = menu.querySelector("select");
      const url = formularios[zona][select.value];
      if (url) window.open(url, '_blank');
    }

    function toggleMenuZona(nro) {
      for (let i = 1; i <= 6; i++) {
        const menu = document.getElementById(`menu-zona${i}`);
        if (menu) {
          const isVisible = (i === nro && menu.dataset.visible !== "true");
          menu.classList.toggle("visible", isVisible);
          menu.dataset.visible = isVisible;
        }
      }
    }
  </script>
</body>
</html>
